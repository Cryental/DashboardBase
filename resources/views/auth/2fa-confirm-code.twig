{% include "partials.main" %}

<head>
    {% include "partials.title-meta" with {'title': '2FA Confirmation'} %}
    {% include "partials.head-css" %}
</head>

<body>

<div class="auth-page-wrapper py-5 d-flex justify-content-center align-items-center min-vh-100">
    <!-- auth page content -->
    <div class="auth-page-content overflow-hidden p-0">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8 col-lg-6 col-xl-5">
                    <div class="card mt-4">
                        <div class="card-body p-4">
                            <div class="text-center mt-2">
                                <h5 class="text-primary">Two-Factor Authentication</h5>
                                <p>You have enabled Two-Factor Authentication for your account. Follow the instructions
                                    to complete setup.</p>
                                <p class="text-center">Android and iOS - Authy</p>
                                <p class="text-center mb-4">Windows Phone - Microsoft Authenticator</p>
                            </div>
                            <form method="POST" autocomplete="off" action="{{ route('two-factor.confirm') }}">
                                <input type="hidden" name="_token" value="{{ csrf_token() }}"/>
                                <div class="mb-3 text-center">
                                    <h5 class="text-primary mb-3">Scan This Code With The App</h5>
                                    {{ auth_user().twoFactorQrCodeSvg()|raw }}
                                </div>
                                <div class="mb-4 text-center">
                                    <p class="text-center">If you can't use a camera, you can use this secret key:</p>
                                    <p class="text-center">{{ twoFactorSecretKey }}</p>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label text-center">Enter the 6-digit code generated by the
                                        app</label>
                                    <input id="code" class="form-control text-center" type="text" name="code"
                                           autocomplete="off" required>
                                </div>
                                <div class="form-footer">
                                    {% if errors is not empty %}
                                        <div class="alert alert-danger">
                                            <p>{{ errors.all()|first }}</p>
                                        </div>
                                    {% endif %}
                                    {% if session('status') is not empty %}
                                        <div class="alert alert-success">
                                            <p>{{ session('status') }}</p>
                                        </div>
                                    {% endif %}
                                    <div class="row">
                                        <div class="col-6">
                                            <button type="button" class="btn w-100" id="2fa-cancel" name="2fa-cancel">
                                                Cancel
                                            </button>
                                        </div>
                                        <div class="col-6">
                                            <button type="submit" class="btn btn-primary w-100">Submit</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <!-- end card body -->
                    </div>
                    <!-- end card -->
                </div>
            </div>
            <!-- end row -->
        </div>
        <!-- end container -->
    </div>
    <!-- end auth page content -->
</div>
<!-- end auth-page-wrapper -->

{% include "partials.vendor-scripts" %}

<script type="text/javascript">
    $('#2fa-cancel').click(function () {
        $.ajax({
            type: 'POST',
            url: '/2fa-cancel',
            data: {
                _token: '{{ csrf_token() }}'
            },
            success: function (data) {
                window.location.href = '{{ route('settings.security') }}';
            }
        });
    });
</script>

</body>
</html>
